<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Online Examination System</title>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
    <link href="css/dashboard-sidebar.css" rel="stylesheet">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>

</head>
<style>
    h3 {
        color: #fff;
        /*        color: #396;*/
    }
    
    #form1 {
        font-family: sans-serif;
        color: #fff;
        display: inline-block;
        font-weight: 100;
        text-align: center;
        font-size: 20px;
    }
    
    #form1 > div {
        padding: 10px;
        border-radius: 10px;
        /*        background: #00BF96;*/
        background: #01A9DB;
        display: inline-block;
    }
    
    #form1 div > span {
        padding: 15px;
        border-radius: 10px;
        background: #00816A;
        display: inline-block;
    }

</style>




<body ng-app="myApp" ng-controller="myCtrl">
    <% include sidebar/dashboard-sidebar %>



        <form id="form1" runat="server" style="margin-left:60px; margin-top:60px;">
            <div class="container text-center">
                <table width="100%" align="center">
                    <tr>
                        <td colspan="2">
                            <h3>Your time start now </h3>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h1>{{min}}:{{sec}}</h1>
                        </td>
                    </tr>
                </table>
            </div>
        </form>





        <div class="container text-center" style="margin-left:60px; margin-top:30px; margin-right:50px;">

            <h4> your topic : {{ques.categories}} </h4>
            <h2> {{ques.question}} </h2>
            <p>
                <button type="button" class="btn btn-default" ng-click="nextquestion(1)">{{ques.option1}}</button>

            </p>
            <p>
                <button type="button" class="btn btn-default" ng-click="nextquestion(2)">{{ques.option2}}</button>

            </p>
            <p>
                <button type="button" class="btn btn-default" ng-click="nextquestion(3)">{{ques.option3}}</button>

            </p>
            <p>
                <button type="button" class="btn btn-default" ng-click="nextquestion(4)">{{ques.option4}}</button>

            </p>

        </div>




        <script>
            var app = angular.module('myApp', []);

            app.controller('myCtrl', function($scope, $http, $location, $timeout) {

                var valuee = $location.url();
                var onlyvalue = valuee.slice(1);
                console.log(onlyvalue);
                var refresh = function() {
                    $http({
                        method: 'POST',
                        url: 'getarandomquestion',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;'
                        },
                        params: {
                            categories: onlyvalue
                        }
                    }).then(function successCallback(response) {
                        if (response) {
                            //console.log(response);
                            if (response.data) {
                                $scope.ques = response.data;
                                $scope.answers = response.data.answers;

                                //console.log(response.data);

                            }
                        } else {
                            console.log(response.data);
                        }

                    }, function errorCallback(response) {

                        console.log(response);
                    });

                }
                refresh();






                $scope.nextquestion = function(value) {
                    console.log("clicked done");

                    $scope.checkanswer(value);

                    $scope.score(value);

                    refresh();
                };




                // timer
                $scope.sec = 60;
                $scope.min = 2;
                $scope.onTimeout = function() {

                    if ($scope.sec == 0) {
                        $scope.sec = 60;

                        $scope.min--;
                        if ($scope.min == -1) {
                            $scope.stop();
                            location.href = "reports";
                        }
                    } else {
                        $scope.sec--;
                    }
                    mytimeout = $timeout($scope.onTimeout, 1000);
                }
                var mytimeout = $timeout($scope.onTimeout, 1000);


                $scope.stop = function() {
                    $timeout.cancel(mytimeout);
                }



                //checkanswer
                $scope.checkanswer = function(value) {
                    if (value == 1) {
                        if ($scope.answers.option1 == true) {
                            console.log('right answer');
                        } else {
                            console.log('wrong answer');
                        }
                    }
                    if (value == 2) {
                        if ($scope.answers.option2 == true) {
                            console.log('right answer');
                        } else {
                            console.log('wrong answer');
                        }
                    }
                    if (value == 3) {

                        if ($scope.answers.option3 == true) {
                            console.log('right answer');
                        } else {
                            console.log('wrong answer');
                        }

                    }
                    if (value == 4) {

                        if ($scope.answers.option4 == true) {
                            console.log('right answer');
                        } else {
                            console.log('wrong answer');
                        }
                    }
                }





                //checkscore
                $scope.score = 0;
                $scope.score = function(value) {
                    if (value == 1) {
                        if ($scope.answers.option1 == true) {
                            $scope.score++;
                            console.log('score 1 added');

                        } else {
                            console.log('no score ');
                        }
                    }
                    if (value == 2) {
                        if ($scope.answers.option2 == true) {
                            $scope.score++;
                            console.log('score 1 added');

                        } else {
                            console.log('no score ');
                        }
                    }
                    if (value == 3) {
                        if ($scope.answers.option3 == true) {
                            $scope.score++;
                            console.log('score 1 added');

                        } else {
                            console.log('no score ');
                        }
                    }
                    if (value == 4) {
                        if ($scope.answers.option4 == true) {
                            $scope.score++;
                            console.log('score 1 added');

                        } else {
                            console.log('no score ');
                        }
                    }
                }






            });

        </script>

</body>

</html>
